SELECT 
        DPD.PLOT_NO,
             DFD.BATCH_MARKETING_NAME||' - '||DFD.BATCH_NO BATCH,
        MS.STATUS,
        ROUND(DPD.MARLA,2) "Marla",
        DPD.ID PLOT_ID,
        DPD.NATURE ,
        DPD.CATEGORY,
        DPF.PLOT_FACTOR,
       --  NVL(DPB.LOCATION_PREFERENCE,'') LOCATION_PREFERENCE,
        'PRINT' PRINT 

FROM DGMS_INVENTORY_MS_HEADER MS
join DGMS_PLOT_DETAILS DPD ON DPD.ID = MS.PLOT_ID AND DPD.ORG_ID = :P_ORG_ID 
LEFT JOIN DGMS_FILES_DETAILS DFD ON DFD.ID=DPD.FILE_ID AND DFD.ORG_ID = :P_ORG_ID
join DGMS_PLOT_FACTORS DPF ON DPF.ID = DPD.FACTOR AND DPD.ORG_ID = :P_ORG_ID
WHERE MS.STATUS IN ('AVAILABLE') AND MS.ORG_ID = :P_ORG_ID
AND NVL(DPD.PLOT_TYPE,'PLOT') = 'PLOT'
AND NVL(DFD.BATCH_NO,'No Batch') = NVL(:P600_BATCH_NO,NVL(DFD.BATCH_NO,'No Batch'))
AND DPD.CATEGORY = NVL(:P600_CATEGORY,DPD.CATEGORY)
AND DPD.NATURE  = NVL(:P600_NATURE,DPD.NATURE )
AND DPF.PLOT_FACTOR = NVL(:P600_FACOTOR,DPF.PLOT_FACTOR)
ORDER BY  DPD.PLOT_NO
